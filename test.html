<!doctype html>
<html>
    <head>
        <title>Tic Tac Toe</title>
    </head>

    <body>

        <div class="yui3-skin-sam" id="console"></div>

        <script src="http://yui.yahooapis.com/3.8.1/build/yui/yui-min.js"></script>
        <script>

/*global YUI: false */

YUI({
    modules: {
        'tic-tac-toe-board': {
            fullpath: 'Javascripts/tic-tac-toe-board.js',
            requires: ['base-build', 'widget']
        },
        'square-row-tools': {
            fullpath: 'Javascripts/square-row-tools.js'
        },
        'get-strand' : {
            fullpath: 'Javascripts/get-strand.js'
        },

        'check-board' : {
            fullpath: 'Javascripts/check-board.js'
        },

        'check-row' : {
            fullpath: 'Javascripts/check-row.js'
        },

        'sift-boards' : {
            fullpath: 'Javascripts/sift-boards.js'
        },

        'project-board' : {
            fullpath: 'Javascripts/project-board.js'
        }

    }
}).use('tic-tac-toe-board', 'test-console', function (Y) {
    "use strict";


    var filteringForAI = new Y.Test.Case({


            'filterAgainstHighestTwoToWinFor O should take an array of boards, none of the boards has a two to win in it and return all possibilities': function () {

                var noTwoToWinsPerBoard,
                    testGame = new Y.ticTacToeBoard();

                noTwoToWinsPerBoard = testGame.makeBoardArrayFromSquareAttrs([['o', 'n', 'o'],
                                                                              ['o', 'x', 'x'],
                                                                              ['x', 'x', 'o']]);

                Y.Assert.areSame(1, noTwoToWinsPerBoard.filterAgainstHighestTwoToWinForO(noTwoToWinsPerBoard.projectAllPossibleBoardsThisTurn(noTwoToWinsPerBoard, 'x')).length);
            },


            'filterAgainstHighestTwoToWinFor O should take an array of boards, two boards should keep the two to wins lowest': function () {

                var fourTwoToWinsPerBoard,
                    testGame = new Y.ticTacToeBoard();

                fourTwoToWinsPerBoard = testGame.makeBoardArrayFromSquareAttrs([['n', 'n', 'o'],
                                                                                ['n', 'x', 'n'],
                                                                                ['o', 'n', 'n']]);

                Y.Assert.areSame(2, fourTwoToWinsPerBoard.filterAgainstHighestTwoToWinForO(fourTwoToWinsPerBoard.projectAllPossibleBoardsThisTurn(fourTwoToWinsPerBoard, 'x')).length);
            },

            'filterAgainstHighestTwoToWinFor O should take an array of boards, eight boards should keep the two to wins lowest': function () {

                var fourTwoToWinsPerBoard,
                    testGame = new Y.ticTacToeBoard();

                fourTwoToWinsPerBoard = testGame.makeBoardArrayFromSquareAttrs([['n', 'n', 'n'],
                                                                                ['n', 'o', 'n'],
                                                                                ['n', 'n', 'n']]);

                Y.Assert.areSame(8, fourTwoToWinsPerBoard.filterAgainstHighestTwoToWinForO(fourTwoToWinsPerBoard.projectAllPossibleBoardsThisTurn(fourTwoToWinsPerBoard, 'x')).length);
            },


            'checkOppositeCornerHazardAgainstO should take a board with an x move in the top left corner, an o move in the center, an x move in the opposite corner and return true, when middle of the top is an o move and there are five turns left in the game': function () {


                var doubleCornerXBoard,
                    testGame = new Y.ticTacToeBoard();

                doubleCornerXBoard = testGame.makeBoardArrayFromSquareAttrs([['x', 'o', 'n'],
                                                                             ['n', 'o', 'n'],
                                                                             ['n', 'n', 'x']]);

                Y.Assert.areSame(true, doubleCornerXBoard.checkOppositeCornerHazardAgainstO(doubleCornerXBoard));
                Y.Assert.areSame(5, Y.checkBoard.possibleMoveLocations(doubleCornerXBoard).length);
            },


            'checkOppositeCornerHazardAgainstO should take a board with an x move in the top right corner and in the opposite corner and return true when an o move is on the right side of the middle row and there are five turns left in the game': function () {

                var doubleCornerXBoard,
                    testGame = new Y.ticTacToeBoard();

                doubleCornerXBoard = testGame.makeBoardArrayFromSquareAttrs([['n', 'n', 'x'],
                                                                             ['n', 'o', 'o'],
                                                                             ['x', 'n', 'n']]);

                Y.Assert.areSame(true, doubleCornerXBoard.checkOppositeCornerHazardAgainstO(doubleCornerXBoard));
                Y.Assert.areSame(5, Y.checkBoard.possibleMoveLocations(doubleCornerXBoard).length);

            },


            'checkOppositeCornerHazardAgainstO should take a board with an x move in the top left corner, an o move in the center, an x move in the opposite corner and return true, when the left of the middle row is an o move and there are five turns left in the game': function () {


                var doubleCornerXBoard,
                    testGame = new Y.ticTacToeBoard();

                doubleCornerXBoard = testGame.makeBoardArrayFromSquareAttrs([['x', 'n', 'n'],
                                                                             ['o', 'o', 'n'],
                                                                             ['n', 'n', 'x']]);

                Y.Assert.areSame(true, doubleCornerXBoard.checkOppositeCornerHazardAgainstO(doubleCornerXBoard));
                Y.Assert.areSame(5, Y.checkBoard.possibleMoveLocations(doubleCornerXBoard).length);
            },


            'checkOppositeCornerHazardAgainstO should take a board with an x move in the top right corner and in the opposite corner and return true when an o move is the middle of the bottom row': function () {

                var doubleCornerXBoard,
                    testGame = new Y.ticTacToeBoard();

                doubleCornerXBoard = testGame.makeBoardArrayFromSquareAttrs([['n', 'n', 'x'],
                                                                             ['n', 'o', 'n'],
                                                                             ['x', 'o', 'n']]);

                Y.Assert.areSame(true, doubleCornerXBoard.checkOppositeCornerHazardAgainstO(doubleCornerXBoard));
                Y.Assert.areSame(5, Y.checkBoard.possibleMoveLocations(doubleCornerXBoard).length);

            },

            'filterAgainstOppositeCornerHazardForO should take an array of boards where xs are in opposite corners and should only return the board that forces a move out of the corner': function () {

                var dangerousArraySeed,
                    testGame = new Y.ticTacToeBoard();

                dangerousArraySeed = testGame.makeBoardArrayFromSquareAttrs([['x', 'n', 'n'],
                                                                            ['n', 'o', 'n'],
                                                                            ['n', 'n', 'x']]);

                Y.Assert.areSame('o', dangerousArraySeed.filterAgainstOppositeCornerHazardForO(dangerousArraySeed.projectAllPossibleBoardsThisTurn())[0][0][1]);

            },

            'findMoveForO should take a board near the end and choose the winning move': function () {

                var endGame,
                    testGame = new Y.ticTacToeBoard();

                endGame = testGame.makeBoardArrayFromSquareAttrs([['x', 'x', 'o'],
                                                                  ['n', 'o', 'n'],
                                                                  ['n', 'n', 'n']]);

                Y.Assert.areSame('o', (endGame.findMoveForO(endGame))[2][0]);

            },

            'findMoveForO should take a board near the end and block a winning move for x': function () {

                var endGame,
                    testGame = new Y.ticTacToeBoard();

                endGame = testGame.makeBoardArrayFromSquareAttrs([['x', 'n', 'o'],
                                                                  ['n', 'o', 'x'],
                                                                  ['x', 'n', 'n']]);

                Y.Assert.areSame('o', (endGame.findMoveForO(endGame))[1][0]);

            },

            'findMoveForO should take a board and pick the choice that minimizes two to wins on Xs side': function () {

                var endGame,
                    testGame = new Y.ticTacToeBoard();

                endGame = testGame.makeBoardArrayFromSquareAttrs([['x', 'n', 'o'],
                                                                  ['n', 'n', 'x'],
                                                                  ['n', 'x', 'n']]);

                Y.Assert.areSame('o', (endGame.findMoveForO(endGame))[1][1]);

            },

            'findMoveForO should take a board with no moves on it and place an o in the center': function () {

                var cornerMoveGame,
                    testGame = new Y.ticTacToeBoard();

                cornerMoveGame = testGame.makeBoardArrayFromSquareAttrs([['n', 'n', 'n'],
                                                                         ['n', 'n', 'n'],
                                                                         ['n', 'n', 'n']]);

                Y.Assert.areSame('o', (cornerMoveGame.findMoveForO(cornerMoveGame))[1][1]);

            },

            'findMoveForO should take a board with a center move and make the first corner move': function () {

                var centerMoveGame,
                    testGame = new Y.ticTacToeBoard();

                centerMoveGame = testGame.makeBoardArrayFromSquareAttrs([['n', 'n', 'n'],
                                                                         ['n', 'x', 'n'],
                                                                         ['n', 'n', 'n']]);

                Y.Assert.areSame('o', (centerMoveGame.findMoveForO(centerMoveGame))[0][0]);
            },


            'findMoveForO should take a board with a corner move and make the center move': function () {

                var cornerMoveGame,
                    testGame = new Y.ticTacToeBoard();

                cornerMoveGame = testGame.makeBoardArrayFromSquareAttrs([['x', 'n', 'n'],
                                                                         ['n', 'n', 'n'],
                                                                         ['n', 'n', 'n']]);

                Y.Assert.areSame('o', (cornerMoveGame.findMoveForO(cornerMoveGame))[1][1]);
            },


        });

    new Y.Test.Console().render('#console');
    Y.Test.Runner.add(filteringForAI);
    Y.Test.Runner.run();
});

        </script>
    </body>
</html>
